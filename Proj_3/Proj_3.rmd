---
title: "DATA 612 - Summer 2020 - Project 3 | Matrix Factorization Methods"
author: "Bruno de Melo and Leland Randles"
date: "June 25, 2020"
output: 
  html_document:
    toc: true # table of content true
    toc_float: true
    toc_depth: 3  # up to three depths of headings (specified by #, ## and ###)
    number_sections: true  #if you want number sections at each table header
    theme: united  # many options for theme, this one is my favorite
    highlight: tango  # specifies the syntax highlighting style
    #css: my.css   # you can add your custom css, should be in same folder
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

if(!require(tidyverse)) install.packages("tidyverse",repos = "http://cran.us.r-project.org")
if(!require(recommenderlab)) install.packages("recommenderlab",repos = "http://cran.us.r-project.org")
library("tidyverse")
library("recommenderlab")
library("knitr")
library("kableExtra")
```

# SVD Explained and Demonstrated
<a href="#top"> Back To Top </a>  
  
In our previous assignment, we studied collaborative filtering and content filtering. Both have their shortcomings. Collaborative filtering focuses on recommending items based on the similarity of items and/or the similarity of users, but suffers from the _cold start_ problem and an inability to consider side features. Content filtering is a challenge because a profile must be built for each item containing multiple characteristics.  
  
In addition, users often associate items in a way which is not easily defined by the characteristics of items. Two movies, for example, might be liked by the same individuals while not having the same genre, actors, box office success, etc. For example, many users might associate two movies because they were both "true to life". We could call these associations "concepts". They are also referred to as latent dimensions or factors.

SVD allows us to take a matrix and decompose it in a way which may allow us to identify such concepts, which can then be used to drive recommendations. It is **always** possible to decompose a real matrix $A$ into three matrices: $U$ (left singular vectors), $\Sigma$ (singular values), and $V$ (right singular values). In terms of a user-item matrix, we can think of $U$ as the "user-to-concept" similarity matrix, the diagonal values of $\Sigma$ as the "strength" of the concepts, and $V$ as the "item-to-concept" similarity matrix:  
  
$$A = U \Sigma V^T$$  
  
## Illustrative "A" Matrix
<a href="#top"> Back To Top </a>  

Below we have a matrix of users (viewers),TV shows and ratings: A zero value means the viewer has not rated the show:    
  
```{r a_matrix}
# Create "A"" Matrix
A <- matrix(c(5, 4, 1, 3, 2, 3, 
              2, 3, 4, 0, 3, 3, 
              3, 0, 5, 0, 4, 5, 
              0, 0, 3, 0, 4, 3, 
              4, 4, 0, 4, 1, 2, 
              0, 4, 3, 3, 3, 3, 
              5, 3, 4, 4, 0, 0, 
              2, 5, 3, 5, 0, 0), nrow = 8, byrow = TRUE)
# Add column and row names
colnames(A) <- c("Westworld","GameOfThrones","BigLittleLies","TheJinx","VicePrincipals","Insecure")
rownames(A) <- c("Viewer1","Viewer2","Viewer3","Viewer4","Viewer5","Viewer6","Viewer7","Viewer8")
kable(A) %>% kable_styling()
```  
<br>

## Decomposition into $U$, $\Sigma$, and $V$
<a href="#top"> Back To Top </a>  
  
Below, the matrix is decomposed into three matrices: $U$ (left singular vectors), $\Sigma$ (singular values), and $V$ (right singular values). In terms of a user-item matrix, we can think of $U$ as the "user-to-concept" similarity matrix, the diagonal values of $\Sigma$ as the "strength" of the concepts, and $V$ as the "item-to-concept" similarity matrix:  

```{r decomp}
x <- svd(A)
U <- x$u
sig <- x$d
V <- x$v
```  
  
The $U$ matrix is a "viewer-to-concept" similarity matrix:  

```{r u}
kable(U) %>% kable_styling()
```
  
The diagonal values of $\Sigma$ (as a matrix) provide the "strength" of the concepts:  
  
```{r sig}
kable(diag(sig)) %>% kable_styling()
```
  
And the $V$ matrix is the "TV show-to-concept" similarity matrix:  
  
```{r v}
kable(V) %>% kable_styling()
```  
  
One challenge is interpreting the concepts. What do they represent? In this case, we have six TV shows which arguably can be put into four genres ("Westworld" and "Game of Thromes") into "scifi/fantasy", "Big Little Lies" into "drama", "The Jinx" into "documentary", and "Vice Principals" and "Insecure" into "comedy". Perhaps some of the shows share directors, cast members, etc. The $\Sigma$ matrix shows six singular values, yet 90% of the energy (discussed later) is encompassed in the first two singular values.  

In a sense, it doesn't matter. SVD brings out the latent dimensions/factors and uses them to recommend shows. Knowing exactly what the latent dimensions/factors are is secondary.

We can demonstrate this more clearly by using SVD on a real dataset.  
  
<br>

# Applying SVD to a Real Dataset
<a href="#top"> Back To Top </a>  


# References

* [Building a Recommendation System with R by Suresh K. Gorakala, Michele Usuelli](https://www.amazon.com/dp/B012O8S1YM/ref=dp-kindle-redirect?_encoding=UTF8&btkr=1)

<a href="#top"> Back To Top </a>  
